(function(j){function g(a){console.error(a)}var u={},r=Array.prototype.slice,k;Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!==typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var c=Array.prototype.slice.call(arguments,1),b=this,d=function(){},e=function(){return b.apply(this instanceof d?this:a,c.concat(Array.prototype.slice.call(arguments)))};d.prototype=this.prototype;e.prototype=new d;return e});for(var v=0,n=
["ms","moz","webkit","o"],l=0;l<n.length&&!window.requestAnimationFrame;++l)window.requestAnimationFrame=window[n[l]+"RequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(a){var c=(new Date).getTime(),b=Math.max(0,16-(c-v)),d=window.setTimeout(function(){a(c+b)},b);v=c+b;return d});var h={on:function(a,c,b){h._validateEventName(a);h._validateCallback(c);"object"!==typeof this._events&&(this._events={});"undefined"===typeof this._events[a]&&(this._events[a]=
[]);this._events[a].push({callback:c,context:b})},off:function(a,c,b){var d;h._validateEventName(a);if(this._events&&this._events[a])if("function"===typeof c)for(d=0;d<this._events[a].length;d++){if(this._events[a][d].callback===c&&this._events[a][d].context===b){this._events[a].splice(d,1);break}}else this._events[a]=[]},trigger:function(a){var c,b,d;h._validateEventName(a);if(this._events&&this._events[a]){b=Array.prototype.slice.call(arguments,1);for(c=0;c<this._events[a].length;c++)d=this._events[a][c].context,
"undefined"===typeof d&&(d=this),this._events[a][c].callback.apply(d,b)}},_validateEventName:function(a){if("string"!==typeof a)throw"eventName must be a string";},_validateCallback:function(a){if("function"!==typeof a)throw"callback must be a function";},handleEvent:function(a,c,b){a.attachEvent?(a["e"+c+b]=b,a[c+b]=function(){a["e"+c+b](window.event)},a.attachEvent("on"+c,a[c+b])):a.addEventListener(c,b,!1)},removeEvent:function(a,c,b){a.detachEvent?(a.detachEvent("on"+c,a[c+b]),a[c+b]=null):a.removeEventListener(c,
b,!1)},attach:function(a){a.prototype.on=h.on;a.prototype.off=h.off;a.prototype.trigger=h.trigger}};k=h;var w=function(a){var c=/[^\w\s]/gi;if("string"===typeof a)return a.replace(c,"");if("undefined"!==typeof jQuery&&a instanceof jQuery)return a.selector.substr(1).replace(c,"");if("object"===typeof a&&1===a.nodeType)return a.id.replace(c,"");g("Player internal key can not be created.")},B=function(a){if(!a)return g("Please provide DOM node"),null;"string"===typeof a&&(a=document.getElementById(a));
"undefined"!==typeof jQuery&&a instanceof jQuery&&(a=a[0]);return null===a||"object"===typeof a&&1!==a.nodeType?(g("DOM node not found"),null):a},x=function(a){var c=0;this.player=a;this.playerParentDOM=null;if(this.playerDOM=this.embed(this.player)){var b=setInterval(function(){this.playerContentDOM=this.playerDOM.contentWindow||this.playerDOM.contentDocument;c++;if(this.playerContentDOM||300<c)c=0,clearInterval(b)}.bind(this),50);this.onPostMessage=this.onPostMessage.bind(this);k.handleEvent(window,
"message",this.onPostMessage)}},s=function(a,c){this.id=parseInt(a,10);this.options=c;this._adapter=null;this._setAdapter(x,this)},y=function(){var a=r.call(arguments,0),c=a[0],b={};b.method=c;a.shift();0<a.length&&(b.params=a);this._adapter.execute(b);this.trigger(c,a)},z={vgtv:"www.vgtv.no","vgtv-stage":"stage.vgtv.no","vgtv2-stage":"stage2.vgtv.no","vgtv2-beta":"beta.vgtv.no","vgtv2-am":"artmicha.vgnett.no/vgtv2",vgtvs:"sponset.vgtv.no",ap:"www.aftenposten.no/webtv","ap-vgtv":"ap.vgtv.no","ap-stage":"ap-stage.vgtv.no",
bt:"www.bt.no/tv","bt-stage":"bt-stage.vgtv.no","bt-vgtv":"bt.vgtv.no",fvn:"www.fvn.no/fvntv","fvn-stage":"fvn-stage.vgtv.no","fvn-vgtv":"fvn.vgtv.no",sa:"www.aftenbladet.no/tv","sa-stage":"sa-stage.vgtv.no","sa-vgtv":"sa.vgtv.no","vgtv-sponset":"www.vgtv.no/annonsorinnhold","vgtv-sponset-stage":"sponset-stage.vgtv.no","ab-stage":"ab.stage.vgtv.no"},m={};x.prototype={embed:function(a){var c=a.id,b=a.options,d="https:"===document.location.protocol?"https://":"http://",e,f;if(isNaN(c))return g("Please provide correct video id"),
null;if(!b)return g("Options object is required"),null;if(!b.vendor)return g("Vendor param is required"),null;if(!z[b.vendor])return g("Vendor '"+b.vendor+"' not found"),null;d+=z[b.vendor]+"/";e=B(b.node);if(null===e)return g("Player can not be embeded"),null;f=document.createElement("iframe");!b.width&&!b.height&&(b.width=e.clientWidth||e.offsetWidth,b.height=e.clientHeight||e.offsetHeight);if("undefined"===typeof b.width||"undefined"===typeof b.height)return g("Can not set width or height of element."),
null;d+="embed/?id="+c;if("number"===typeof b.index||"number"===typeof b.chapter)d+="&index="+(b.index||b.chapter);"string"===typeof b.skin&&(d+="&skin="+b.skin);"boolean"===typeof b.autoplay&&!0===b.autoplay&&(d+="&autoplay=true");"string"===typeof b.poster&&(d+="&poster="+encodeURIComponent(b.poster));"string"===typeof b.title&&(d+="&title="+encodeURIComponent(b.title));"string"===typeof b.site&&(d+="&site="+b.site);"string"===typeof b.statistics&&(d+="&statistics="+b.statistics);"string"===typeof b.tags&&
(d+="&tags="+b.tags);if(b.settings){d+="&s=1";if((!0===b.settings.bgPlay||"string"===typeof b.settings.bgPlay&&b.settings.bgPlay.indexOf&&0===b.settings.bgPlay.indexOf("testOn"))&&null===navigator.userAgent.match(/(iPhone)|(iPad)|(^(?=.*Android)(?!.*Windows).*)/i))a.on("ready",this.attachBackgroundPlay.bind(this,e));a.on("backgroundPlay",function(){b.settings.bgPlay=!1}.bind(this))}f.src=d;f.width=b.width;f.height=b.height;f.setAttribute("frameBorder","0");f.setAttribute("scrolling","no");f.setAttribute("allowfullscreen",
"true");f.style.border="0px";f.style.padding="0";e.hasChildNodes()&&(e.innerHTML="");e.appendChild(f);this.playerParentDOM=e;return f},attachBackgroundPlay:function(a){var c=a.offsetTop,b=c-window.innerHeight,d=c+a.offsetHeight,e=0,f=!1,g;g=function(){window.requestAnimationFrame(function(){e=window.scrollYOffset||document.body.scrollTop||document.documentElement.scrollTop;e>b&&e<d?f||(f=!0,this.player.play()):f&&(f=!1,this.player.pause())}.bind(this))}.bind(this);k.handleEvent(window,"scroll",g);
this.player.on("backgroundPlay",function(){k.removeEvent(window,"scroll",g)});g()},execute:function(a){this.playerContentDOM&&this.playerContentDOM.postMessage(JSON.stringify(a),"*")},onPostMessage:function(a){this.playerContentDOM===a.source&&(a.data&&a.data.split)&&this.player.trigger.apply(this.player,a.data.split(":"))},destroy:function(){this.playerParentDOM&&(this.playerParentDOM.innerHTML=null);k.removeEvent(window,"message",this.onPostMessage)}};var n=function(a){return function(){var c=r.call(arguments,
0);c.unshift(a);y.apply(this,c)}},l=["play","resume","pause","seek","setOption"],p,q,A,t;p={_setAdapter:function(a){function c(){return a.apply(this,b)}var b=r.call(arguments,1);c.prototype=a.prototype;this._adapter=new c(b)},destroy:function(){this._adapter.destroy();this.trigger("destroy",this)}};q=0;for(A=l.length;q<A;q++)t=l[q],p[t]=n.call(p,t);s.prototype=p;k.attach(s);var C=function(a){a.off("destroy");delete m[w(a.options.node)]},D=function(){this.options.settings&&y.call(this,"init",this.options.settings)};
u.Player={load:function(a,c){var b=w(c.node),d;b in m||(d=new s(a,c),d.on("destroy",C),d.on("load",D),m[b]=d);return m[b]},get:function(a){a in m||g("Player: "+a+" not found");return m[a]}};j.setTimeout(function(){"function"===typeof j.svpAsyncInit&&!j.svpAsyncInit.hasRun&&(j.svpAsyncInit.hasRun=!0,j.svpAsyncInit())},0);j.SVP=u})(window);
